use crate::names::CNTB;
use nom::character::complete::multispace0;
use nom::number::complete::float;
use nom::IResult;
use nom::sequence::tuple;
use serde::{Serialize,Deserialize};
use crate::parse_rvm::parse_bboxLocal;
use std::borrow::Borrow;
use std::rc::Rc;
use nom::bytes::complete::take_until;

#[derive(Debug,Serialize,Deserialize,PartialEq,Clone)]
#[cfg_attr(feature = "serde", derive(serde::Serialize, serde::Deserialize))]
pub enum PrimShapes{
    PyramidShape(Pyramid),
    BoxShape(Box),
    RectangularTorusShape(RectangularTorus),
    CircularTorusShape(CircularTorus),
    EllipticalDishShape(EllipticalDish),//5
    SphericalDishShape(SphericalDish),
    SnoutShape(Snout),
    CylinderShape(Cylinder),
    SphereShape(Sphere),
    LineShape(Line),
    FacetGroupShape(FacetGroup)
}
#[derive(Debug,Serialize,Deserialize,PartialEq,Clone)]
pub enum PrimShape{
    PyramidShape,
    BoxShape,
    RectangularTorusShape,
    CircularTorusShape,
    EllipticalDishShape,
    SphericalDishShape,//6
    SnoutShape,
    CylinderShape,
    SphereShape,
    LineShape,
    FacetGroup,
}

//金字塔形 1
#[derive(Debug,Serialize,Deserialize,PartialEq,Clone)]
pub struct Pyramid{
    pub bottom:[f32;2],
    pub top:[f32;2],
    pub offset:[f32;2],
    pub height:f32,
}
//2
#[derive(Debug,Serialize,Deserialize,PartialEq,Clone)]
pub struct Box{
    pub lengths:[f32;3],
}
//矩形环面 3
#[derive(Debug,Serialize,Deserialize,PartialEq,Clone)]
pub struct RectangularTorus{
    pub inner_radius:f32,
    pub outer_radius:f32,
    pub height:f32,
    pub angle:f32,
}
//圆环 4
#[derive(Debug,Serialize,Deserialize,PartialEq,Clone)]
pub struct  CircularTorus{
    pub offset:f32,
    pub radius:f32,
    pub angle:f32,
}
//椭圆盘 5
#[derive(Debug,Serialize,Deserialize,PartialEq,Clone)]
pub struct EllipticalDish{
    pub baseRadius:f32,
    pub height:f32,
}
//球盘 6
#[derive(Debug,Serialize,Deserialize,PartialEq,Clone)]
pub struct SphericalDish{
    pub baseRadius:f32,
    pub height:f32,
}
//7
#[derive(Debug,Serialize,Deserialize,PartialEq,Clone)]
pub struct Snout{
    pub offset:[f32;2],
    pub bshear:[f32;2],
    pub tshear:[f32;2],
    pub radius_b:f32,
    pub radius_t:f32,
    pub height:f32,
}
//8
#[derive(Debug,Serialize,Deserialize,PartialEq,Clone)]
pub struct Cylinder{
    pub radius:f32,
    pub height:f32,
}
//9
#[derive(Debug,Serialize,Deserialize,PartialEq,Clone)]
pub struct Sphere{
    pub diameter:f32,
}
//10
#[derive(Debug,Serialize,Deserialize,PartialEq,Clone)]
pub struct Line{
    pub a:f32,
    pub b:f32,
}
//11
#[derive(Debug,Serialize,Deserialize,PartialEq,Clone)]
pub struct FacetGroup{
    pub data:Vec<[f32;6]>,
}
//1
pub fn tuple_pyramid(input:&str) ->IResult<&str,Pyramid>{
    let (input,(_,x,_,y,_,z,_,a,_,b,_,c,_,d))=tuple((
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
    ))(input)?;
    Ok((input,Pyramid{
        bottom: [x,y],
        top: [z,a],
        offset: [b,c],
        height: d
    }))

}
//2
pub fn tuple_box(input:&str)->IResult<&str,Box>{
    let (input,(_, x, _, y, _, z))=tuple((
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
    ))(input)?;
    Ok((input,Box{
        lengths: [x,y,z]
    }))
}
//3
pub fn tuple_rectangularTorus(input:&str)->IResult<&str,RectangularTorus>{
    let (input,(_, a, _, b,_, c,_,d))=tuple((
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
    ))(input)?;
    Ok((input,RectangularTorus{
        inner_radius: a,
        outer_radius: b,
        height: c,
        angle: d
    }))
}
//4
pub fn tuple_CircularTorus(input:&str)->IResult<&str,CircularTorus>{
    let (input,(_, x,_,y,_,z))=tuple((
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
    ))(input)?;
    Ok((input,CircularTorus{
        offset: x,
        radius: y,
        angle: z
    }))
}
//5
pub fn tuple_EllipticalDish(input:&str)->IResult<&str,EllipticalDish>{
    let (input,(_, x, _, y))=tuple((
        multispace0,
        float,
        multispace0,
        float,
    ))(input)?;
    Ok((input,EllipticalDish{
        baseRadius: x,
        height: y
    }))
}
//6
pub fn tuple_SphericalDish(input:&str)->IResult<&str,SphericalDish>{
    let (input,(_, x, _, y))=tuple((
        multispace0,
        float,
        multispace0,
        float,
    ))(input)?;
    Ok((input,SphericalDish{
        baseRadius: x,
        height: y
    }))
}
//7
pub fn tuple_Snout(input:&str)->IResult<&str,Snout>{
    let (input,(_,a,_,b,_,c,_,d,_,e,_,f,_,g,_,h,_,i)
    )=tuple((
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
        multispace0,
        float,
    ))(input)?;
    Ok((input,Snout{
        offset: [a,b],
        bshear: [c,d],
        tshear: [e,f],
        radius_b: g,
        radius_t: h,
        height:   i
    }))
}
//8
pub fn tuple_Cylinder(input:&str)->IResult<&str,Cylinder>{
    let (input,(_,x,_,y))=tuple((
        multispace0,
        float,
        multispace0,
        float,
    ))(input)?;
    Ok((input,Cylinder{
        radius: x,
        height: y
    }))
}
//9
pub fn tuple_Sphere(input:&str)->IResult<&str,Sphere>{
    let (input,(_,x))=tuple((
        multispace0,
        float,
    ))(input)?;
    Ok((input,Sphere{
        diameter: x
    }))
}
//10
pub fn tuple_Line(input:&str)->IResult<&str,Line>{
    let (input,(_,a, _,b))=tuple((
        multispace0,
        float,
        multispace0,
        float,
    ))(input)?;
    Ok((input,Line{
        a,
        b
    }))
}
//11
pub fn tuple_FacetGroup(mut input: &str, mut arr:Vec<[f32;6]>) ->IResult<&str, FacetGroup> {
    //取到他的18这个值，不知道是用来干什么的，推测是存储数据的组数
    let (input_1,(_, mut times))=tuple((
        multispace0,
        float,
        ))(input)?;
    let mut tep:f32=0.0;
    input=input_1;
    //根据这个组数，循环解析数据
    while tep<(times){
        //组数下面的数是一个类型（4,8）出现的次数，目前发现了1,2 ，用循环解析
         let (input_1,(_, in_times))=tuple((
            multispace0,
            float,
        ))(input)?;
        input=input_1;
        let mut in_tep:f32=0.0;
        //解析组数下面的类型，目前只发现4和8，代表几组bboxlocal数据，这里没有用循环，因为只发现了4和8两种数，循环的话太耗内存
        while in_tep<in_times{
            let (input_1,(_,tuple_times))=tuple((
                multispace0,
                float,
            ))(input)?;
            input=input_1;
            let mut tuple_time=0.0;
            while tuple_time<tuple_times{
                let (input_1,(x,))=tuple((
                    parse_bboxLocal,
                    ))(input)?;
                input=input_1;
                arr.push(x);
                tuple_time+=1.0;
            }
            in_tep+=1.0;
        }
        tep+=1.0;
    }
    Ok((input, FacetGroup{
        data: arr,
    }))
}
#[test]
fn test_tuple_FacetGroup(){
    let mut input="32
     2
    12
       3014.98       6664.75       3105.00
     0.0000000     0.0000000     1.0000000
       3040.50       6760.00       3105.00
     0.0000000     0.0000000     1.0000000
       3014.98       6855.25       3105.00
     0.0000000     0.0000000     1.0000000
       2945.25       6924.98       3105.00
     0.0000000     0.0000000     1.0000000
       2850.00       6950.50       3105.00
     0.0000000     0.0000000     1.0000000
       2754.75       6924.98       3105.00
     0.0000000     0.0000000     1.0000000
       2685.02       6855.25       3105.00
     0.0000000     0.0000000     1.0000000
       2659.50       6760.00       3105.00
     0.0000000     0.0000000     1.0000000
       2685.02       6664.75       3105.00
     0.0000000     0.0000000     1.0000000
       2754.75       6595.02       3105.00
     0.0000000     0.0000000     1.0000000
       2850.00       6569.50       3105.00
     0.0000000     0.0000000     1.0000000
       2945.25       6595.02       3105.00
     0.0000000     0.0000000     1.0000000
     8
       2772.57       6682.57       3105.00
     0.0000000     0.0000000     1.0000000
       2740.50       6760.00       3105.00
     0.0000000     0.0000000     1.0000000
       2772.57       6837.43       3105.00
     0.0000000     0.0000000     1.0000000
       2850.00       6869.50       3105.00
     0.0000000     0.0000000     1.0000000
       2927.43       6837.43       3105.00
     0.0000000     0.0000000     1.0000000
       2959.50       6760.00       3105.00
     0.0000000     0.0000000     1.0000000
       2927.43       6682.57       3105.00
     0.0000000     0.0000000     1.0000000
       2850.00       6650.50       3105.00
     0.0000000     0.0000000     1.0000000
     2
    12
       3040.50       6760.00       3064.00
     0.0000000     0.0000000    -1.0000000
       3014.98       6664.75       3064.00
     0.0000000     0.0000000    -1.0000000
       2945.25       6595.02       3064.00
     0.0000000     0.0000000    -1.0000000
       2850.00       6569.50       3064.00
     0.0000000     0.0000000    -1.0000000
       2754.75       6595.02       3064.00
     0.0000000     0.0000000    -1.0000000
       2685.02       6664.75       3064.00
     0.0000000     0.0000000    -1.0000000
       2659.50       6760.00       3064.00
     0.0000000     0.0000000    -1.0000000
       2685.02       6855.25       3064.00
     0.0000000     0.0000000    -1.0000000
       2754.75       6924.98       3064.00
     0.0000000     0.0000000    -1.0000000
       2850.00       6950.50       3064.00
     0.0000000     0.0000000    -1.0000000
       2945.25       6924.98       3064.00
     0.0000000     0.0000000    -1.0000000
       3014.98       6855.25       3064.00
     0.0000000     0.0000000    -1.0000000
     8
       2740.50       6760.00       3064.00
     0.0000000     0.0000000    -1.0000000
       2772.57       6682.57       3064.00
     0.0000000     0.0000000    -1.0000000
       2850.00       6650.50       3064.00
     0.0000000     0.0000000    -1.0000000
       2927.43       6682.57       3064.00
     0.0000000     0.0000000    -1.0000000
       2959.50       6760.00       3064.00
     0.0000000     0.0000000    -1.0000000
       2927.43       6837.43       3064.00
     0.0000000     0.0000000    -1.0000000
       2850.00       6869.50       3064.00
     0.0000000     0.0000000    -1.0000000
       2772.57       6837.43       3064.00
     0.0000000     0.0000000    -1.0000000
     1
     4
       3040.50       6760.00       3105.00
     1.0000000     0.0000000     0.0000000
       3014.98       6664.75       3105.00
     0.8660254    -0.5000000     0.0000000
       3014.98       6664.75       3064.00
     0.8660254    -0.5000000     0.0000000
       3040.50       6760.00       3064.00
     1.0000000     0.0000000     0.0000000
     1
     4
       3014.98       6664.75       3105.00
     0.8660254    -0.5000000     0.0000000
       2945.25       6595.02       3105.00
     0.5000000    -0.8660254     0.0000000
       2945.25       6595.02       3064.00
     0.5000000    -0.8660254     0.0000000
       3014.98       6664.75       3064.00
     0.8660254    -0.5000000     0.0000000
     1
     4
       2945.25       6595.02       3105.00
     0.5000000    -0.8660254     0.0000000
       2850.00       6569.50       3105.00
     0.0000000    -1.0000000     0.0000000
       2850.00       6569.50       3064.00
     0.0000000    -1.0000000     0.0000000
       2945.25       6595.02       3064.00
     0.5000000    -0.8660254     0.0000000
     1
     4
       2850.00       6569.50       3105.00
     0.0000000    -1.0000000     0.0000000
       2754.75       6595.02       3105.00
    -0.5000000    -0.8660254     0.0000000
       2754.75       6595.02       3064.00
    -0.5000000    -0.8660254     0.0000000
       2850.00       6569.50       3064.00
     0.0000000    -1.0000000     0.0000000
     1
     4
       2754.75       6595.02       3105.00
    -0.5000000    -0.8660254     0.0000000
       2685.02       6664.75       3105.00
    -0.8660254    -0.5000000     0.0000000
       2685.02       6664.75       3064.00
    -0.8660254    -0.5000000     0.0000000
       2754.75       6595.02       3064.00
    -0.5000000    -0.8660254     0.0000000
     1
     4
       2685.02       6664.75       3105.00
    -0.8660254    -0.5000000     0.0000000
       2659.50       6760.00       3105.00
    -1.0000000     0.0000000     0.0000000
       2659.50       6760.00       3064.00
    -1.0000000     0.0000000     0.0000000
       2685.02       6664.75       3064.00
    -0.8660254    -0.5000000     0.0000000
     1
     4
       2659.50       6760.00       3105.00
    -1.0000000     0.0000000     0.0000000
       2685.02       6855.25       3105.00
    -0.8660254     0.5000000     0.0000000
       2685.02       6855.25       3064.00
    -0.8660254     0.5000000     0.0000000
       2659.50       6760.00       3064.00
    -1.0000000     0.0000000     0.0000000
     1
     4
       2685.02       6855.25       3105.00
    -0.8660254     0.5000000     0.0000000
       2754.75       6924.98       3105.00
    -0.5000000     0.8660254     0.0000000
       2754.75       6924.98       3064.00
    -0.5000000     0.8660254     0.0000000
       2685.02       6855.25       3064.00
    -0.8660254     0.5000000     0.0000000
     1
     4
       2754.75       6924.98       3105.00
    -0.5000000     0.8660254     0.0000000
       2850.00       6950.50       3105.00
     0.0000000     1.0000000     0.0000000
       2850.00       6950.50       3064.00
     0.0000000     1.0000000     0.0000000
       2754.75       6924.98       3064.00
    -0.5000000     0.8660254     0.0000000
     1
     4
       2850.00       6950.50       3105.00
     0.0000000     1.0000000     0.0000000
       2945.25       6924.98       3105.00
     0.5000000     0.8660254     0.0000000
       2945.25       6924.98       3064.00
     0.5000000     0.8660254     0.0000000
       2850.00       6950.50       3064.00
     0.0000000     1.0000000     0.0000000
     1
     4
       2945.25       6924.98       3105.00
     0.5000000     0.8660254     0.0000000
       3014.98       6855.25       3105.00
     0.8660254     0.5000000     0.0000000
       3014.98       6855.25       3064.00
     0.8660254     0.5000000     0.0000000
       2945.25       6924.98       3064.00
     0.5000000     0.8660254     0.0000000
     1
     4
       3014.98       6855.25       3105.00
     0.8660254     0.5000000     0.0000000
       3040.50       6760.00       3105.00
     1.0000000     0.0000000     0.0000000
       3040.50       6760.00       3064.00
     1.0000000     0.0000000     0.0000000
       3014.98       6855.25       3064.00
     0.8660254     0.5000000     0.0000000
     2
     8
       2927.43       6682.57       3105.00
     0.0000000     0.0000000     1.0000000
       2959.50       6760.00       3105.00
     0.0000000     0.0000000     1.0000000
       2927.43       6837.43       3105.00
     0.0000000     0.0000000     1.0000000
       2850.00       6869.50       3105.00
     0.0000000     0.0000000     1.0000000
       2772.57       6837.43       3105.00
     0.0000000     0.0000000     1.0000000
       2740.50       6760.00       3105.00
     0.0000000     0.0000000     1.0000000
       2772.57       6682.57       3105.00
     0.0000000     0.0000000     1.0000000
       2850.00       6650.50       3105.00
     0.0000000     0.0000000     1.0000000
     8
       2920.71       6689.29       3105.00
     0.0000000     0.0000000     1.0000000
       2850.00       6660.00       3105.00
     0.0000000     0.0000000     1.0000000
       2779.29       6689.29       3105.00
     0.0000000     0.0000000     1.0000000
       2750.00       6760.00       3105.00
     0.0000000     0.0000000     1.0000000
       2779.29       6830.71       3105.00
     0.0000000     0.0000000     1.0000000
       2850.00       6860.00       3105.00
     0.0000000     0.0000000     1.0000000
       2920.71       6830.71       3105.00
     0.0000000     0.0000000     1.0000000
       2950.00       6760.00       3105.00
     0.0000000     0.0000000     1.0000000
     2
     8
       2959.50       6760.00       2855.00
     0.0000000     0.0000000    -1.0000000
       2927.43       6682.57       2855.00
     0.0000000     0.0000000    -1.0000000
       2850.00       6650.50       2855.00
     0.0000000     0.0000000    -1.0000000
       2772.57       6682.57       2855.00
     0.0000000     0.0000000    -1.0000000
       2740.50       6760.00       2855.00
     0.0000000     0.0000000    -1.0000000
       2772.57       6837.43       2855.00
     0.0000000     0.0000000    -1.0000000
       2850.00       6869.50       2855.00
     0.0000000     0.0000000    -1.0000000
       2927.43       6837.43       2855.00
     0.0000000     0.0000000    -1.0000000
     8
       2920.71       6689.29       2855.00
     0.0000000     0.0000000    -1.0000000
       2950.00       6760.00       2855.00
     0.0000000     0.0000000    -1.0000000
       2920.71       6830.71       2855.00
     0.0000000     0.0000000    -1.0000000
       2850.00       6860.00       2855.00
     0.0000000     0.0000000    -1.0000000
       2779.29       6830.71       2855.00
     0.0000000     0.0000000    -1.0000000
       2750.00       6760.00       2855.00
     0.0000000     0.0000000    -1.0000000
       2779.29       6689.29       2855.00
     0.0000000     0.0000000    -1.0000000
       2850.00       6660.00       2855.00
     0.0000000     0.0000000    -1.0000000
     1
     4
       2927.43       6682.57       3064.00
     0.7071068    -0.7071068     0.0000000
       2927.43       6682.57       2855.00
     0.7071068    -0.7071068     0.0000000
       2959.50       6760.00       2855.00
     1.0000000     0.0000000     0.0000000
       2959.50       6760.00       3064.00
     1.0000000     0.0000000     0.0000000
     1
     4
       2850.00       6650.50       3064.00
     0.0000000    -1.0000000     0.0000000
       2850.00       6650.50       2855.00
     0.0000000    -1.0000000     0.0000000
       2927.43       6682.57       2855.00
     0.7071068    -0.7071068     0.0000000
       2927.43       6682.57       3064.00
     0.7071068    -0.7071068     0.0000000
     1
     4
       2772.57       6682.57       3064.00
    -0.7071068    -0.7071068     0.0000000
       2772.57       6682.57       2855.00
    -0.7071068    -0.7071068     0.0000000
       2850.00       6650.50       2855.00
     0.0000000    -1.0000000     0.0000000
       2850.00       6650.50       3064.00
     0.0000000    -1.0000000     0.0000000
     1
     4
       2740.50       6760.00       3064.00
    -1.0000000     0.0000000     0.0000000
       2740.50       6760.00       2855.00
    -1.0000000     0.0000000     0.0000000
       2772.57       6682.57       2855.00
    -0.7071068    -0.7071068     0.0000000
       2772.57       6682.57       3064.00
    -0.7071068    -0.7071068     0.0000000
     1
     4
       2772.57       6837.43       3064.00
    -0.7071068     0.7071068     0.0000000
       2772.57       6837.43       2855.00
    -0.7071068     0.7071068     0.0000000
       2740.50       6760.00       2855.00
    -1.0000000     0.0000000     0.0000000
       2740.50       6760.00       3064.00
    -1.0000000     0.0000000     0.0000000
     1
     4
       2850.00       6869.50       3064.00
     0.0000000     1.0000000     0.0000000
       2850.00       6869.50       2855.00
     0.0000000     1.0000000     0.0000000
       2772.57       6837.43       2855.00
    -0.7071068     0.7071068     0.0000000
       2772.57       6837.43       3064.00
    -0.7071068     0.7071068     0.0000000
     1
     4
       2927.43       6837.43       3064.00
     0.7071068     0.7071068     0.0000000
       2927.43       6837.43       2855.00
     0.7071068     0.7071068     0.0000000
       2850.00       6869.50       2855.00
     0.0000000     1.0000000     0.0000000
       2850.00       6869.50       3064.00
     0.0000000     1.0000000     0.0000000
     1
     4
       2927.43       6837.43       2855.00
     0.7071068     0.7071068     0.0000000
       2927.43       6837.43       3064.00
     0.7071068     0.7071068     0.0000000
       2959.50       6760.00       3064.00
     1.0000000     0.0000000     0.0000000
       2959.50       6760.00       2855.00
     1.0000000     0.0000000     0.0000000
     1
     5
       2950.00       6760.00       3105.00
    -1.0000000     0.0000000     0.0000000
       2950.00       6760.00       2855.00
    -1.0000000     0.0000000     0.0000000
       2920.71       6689.29       2855.00
    -0.7071068     0.7071068     0.0000000
       2920.71       6689.29       3064.00
    -0.7071068     0.7071068     0.0000000
       2920.71       6689.29       3105.00
    -0.9238795     0.3826834     0.0000000
     1
     6
       2850.00       6660.00       3105.00
     0.3826834     0.9238795     0.0000000
       2850.00       6660.00       3064.00
     0.0000000     1.0000000     0.0000000
       2850.00       6660.00       2855.00
     0.0000000     1.0000000     0.0000000
       2779.29       6689.29       2855.00
     0.7071068     0.7071068     0.0000000
       2779.29       6689.29       3064.00
     0.7071068     0.7071068     0.0000000
       2779.29       6689.29       3105.00
     0.3826834     0.9238795     0.0000000
     1
     6
       2850.00       6860.00       3064.00
     0.0000000    -1.0000000     0.0000000
       2850.00       6860.00       3105.00
     0.3826834    -0.9238795     0.0000000
       2779.29       6830.71       3105.00
     0.3826834    -0.9238795     0.0000000
       2779.29       6830.71       3064.00
     0.7071068    -0.7071068     0.0000000
       2779.29       6830.71       2855.00
     0.7071068    -0.7071068     0.0000000
       2850.00       6860.00       2855.00
     0.0000000    -1.0000000     0.0000000
     1
     5
       2950.00       6760.00       2855.00
    -1.0000000     0.0000000     0.0000000
       2950.00       6760.00       3105.00
    -1.0000000     0.0000000     0.0000000
       2920.71       6830.71       3105.00
    -0.7071068    -0.7071068     0.0000000
       2920.71       6830.71       3064.00
    -0.7071068    -0.7071068     0.0000000
       2920.71       6830.71       2855.00
    -0.7071068    -0.7071068     0.0000000
     1
     6
       2920.71       6689.29       3064.00
    -0.7071068     0.7071068     0.0000000
       2920.71       6689.29       2855.00
    -0.7071068     0.7071068     0.0000000
       2850.00       6660.00       2855.00
     0.0000000     1.0000000     0.0000000
       2850.00       6660.00       3064.00
     0.0000000     1.0000000     0.0000000
       2850.00       6660.00       3105.00
    -0.3826834     0.9238795     0.0000000
       2920.71       6689.29       3105.00
    -0.3826834     0.9238795     0.0000000
     1
     6
       2779.29       6689.29       3105.00
     0.9238795     0.3826834     0.0000000
       2779.29       6689.29       3064.00
     0.7071068     0.7071068     0.0000000
       2779.29       6689.29       2855.00
     0.7071068     0.7071068     0.0000000
       2750.00       6760.00       2855.00
     1.0000000     0.0000000     0.0000000
       2750.00       6760.00       3064.00
     1.0000000     0.0000000     0.0000000
       2750.00       6760.00       3105.00
     1.0000000     0.0000000     0.0000000
     1
     6
       2750.00       6760.00       3105.00
     1.0000000     0.0000000     0.0000000
       2750.00       6760.00       3064.00
     1.0000000     0.0000000     0.0000000
       2750.00       6760.00       2855.00
     1.0000000     0.0000000     0.0000000
       2779.29       6830.71       2855.00
     0.7071068    -0.7071068     0.0000000
       2779.29       6830.71       3064.00
     0.7071068    -0.7071068     0.0000000
       2779.29       6830.71       3105.00
     0.9238795    -0.3826834     0.0000000
     1
     6
       2850.00       6860.00       3105.00
    -0.3826834    -0.9238795     0.0000000
       2850.00       6860.00       3064.00
     0.0000000    -1.0000000     0.0000000
       2850.00       6860.00       2855.00
     0.0000000    -1.0000000     0.0000000
       2920.71       6830.71       2855.00
    -0.7071068    -0.7071068     0.0000000
       2920.71       6830.71       3064.00
    -0.7071068    -0.7071068     0.0000000
       2920.71       6830.71       3105.00
    -0.7071068    -0.7071068     0.0000000

     ";
    let arr=vec![];
    let(input,out)=tuple_FacetGroup(& input,arr).unwrap();
    println!("input={:?}",input);
    println!("out={:?}",out);
}